{
    "collab_server" : "",
    "contents" : "---\ntitle: \"ChIP-seq Working With Peaks - practical\"\nauthor: \"MRC CSC Bioinformatics Core\"\ndate: \"22 February 2016\"\noutput: rmarkdown::html_vignette\nvignette: >\n  %\\VignetteIndexEntry{Vignette Title}\n  %\\VignetteEngine{knitr::rmarkdown}\n  %\\VignetteEncoding{UTF-8}\n---\n\nIn this practical we will read in two replicate sets of peaks from the Myc Encode dataset,filter by fold enrichment over input and find the number of peaks common to both replicates and those unique to either.\n\n\n* First read in each of the Mel replicate peak sets found in MacsPeaks directory and create a GRanges object containing peak locations for each.\n\n```{r setup, include=FALSE}\nknitr::opts_chunk$set(echo = T,eval = T)\n```\n\n```{r,collapse=T}\n# Load the GenomicRanges Library .. here is suppress messages for a cleaner document\nsuppressPackageStartupMessages(\n  library(GenomicRanges)\n  )\n\npeakFile1 <- system.file(\"extdata\", \"/MacsPeaks/mycmelrep1_peaks.xls\", package = \"ChIPseqShort\")\npeakFile2 <- system.file(\"extdata\", \"/MacsPeaks/mycmelrep2_peaks.xls\", package = \"ChIPseqShort\")\n\nmelPeak_Rep1 <- read.delim(peakFile1,sep=\"\\t\",comment.char = \"#\")\nmelPeak_Rep2 <- read.delim(peakFile2,sep=\"\\t\",comment.char = \"#\")\n\nmelRep1_GR <- GRanges(\n                  seqnames=melPeak_Rep1[,\"chr\"],\n                  IRanges(melPeak_Rep1[,\"start\"],\n                  melPeak_Rep1[,\"end\"]\n                  )\n                )\n\nmcols(melRep1_GR) <- melPeak_Rep1[,c(\"abs_summit\", \"fold_enrichment\")]\n\nmelRep1_GR\n\nmelRep2_GR <- GRanges(\n                  seqnames=melPeak_Rep2[,\"chr\"],\n                  IRanges(melPeak_Rep2[,\"start\"],\n                  melPeak_Rep2[,\"end\"]\n                  )\n                )\n\nmcols(melRep2_GR) <- melPeak_Rep2[,c(\"abs_summit\", \"fold_enrichment\")]\n\nmelRep2_GR\n\n```\n\nNow you have your peak sets as GRanges, you can start to work with the peaks in R.\n\n* Find the number of peaks in each replicate.\n\n* Find the number of peaks in each replicate on chromosome 4.\n\n* Find the number of peaks on chromosome 4 which have a 5 fold enrichment above input.\n\n```{r, warnings=F,collapse=T}\n# Number of peaks\n\nlength(melRep1_GR)\n\nlength(melRep2_GR)\n\n# Number of peaks on chromosome 4\n\n# Using table on logical vector\n\ntable(seqnames(melRep1_GR) %in% \"4\")\n\ntable(seqnames(melRep2_GR) %in% \"4\")\n\n# Indexing and recounting\n\nlength(melRep1_GR[seqnames(melRep1_GR) %in% \"4\"])\n\nlength(melRep2_GR[seqnames(melRep2_GR) %in% \"4\"])\n\n\n# Number of peaks on chromosome 4 and with 5 fold enrichment above input\n\n# Using table on logical vector\n\ntable(seqnames(melRep1_GR) %in% \"4\" & melRep1_GR$fold_enrichment > 5)\n\ntable(seqnames(melRep2_GR) %in% \"4\" & melRep2_GR$fold_enrichment > 5)\n\n# Indexing and recounting\n\nlength(melRep1_GR[seqnames(melRep1_GR) %in% \"4\" & melRep1_GR$fold_enrichment > 5])\n\nlength(melRep2_GR[seqnames(melRep2_GR) %in% \"4\" & melRep2_GR$fold_enrichment > 5])\n\n```\n\n\nNow we can use our GRanges to identify the peak in common or unique to replicates.\n\n* Find the number of replicate 1 peaks common between replicates.\n* Find the number of unique peaks in replicate 1\n\n```{r, warnings=F,collapse=T}\n\n# Using table\n\ntable(melRep1_GR %over% melRep2_GR)\n\n# Using index and recounting\nlength(melRep1_GR[melRep1_GR %over% melRep2_GR])\n\n\n# Using table\n\ntable(!melRep1_GR %over% melRep2_GR)\n\n# Using index and recounting\nlength(melRep1_GR[!melRep1_GR %over% melRep2_GR])\n\ncommonMelPeaks <- melRep1_GR[melRep1_GR %over% melRep2_GR]\n```\n\nFor a bonus question. \n\n* Create a new GRanges of the summit locations from Mel Myc Peaks replicate 1.\n\n```{r, warnings=F,collapse=T}\n\n# Using table\n\nmelRep1_GRSummits <- melRep1_GR\n\nstart(melRep1_GRSummits) <- end(melRep1_GRSummits) <- melRep1_GR$abs_summit\n\nmelRep1_GRSummits\n```\n\n",
    "created" : 1465339491644.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "4027726198",
    "id" : "F894544F",
    "lastKnownWriteTime" : 1465341738,
    "last_content_update" : 1465341738803,
    "path" : "~/GitHub/Unlinked_ButClose/ChIPseqShort/vignettes/WorkingWithPeaks.Rmd",
    "project_path" : "vignettes/WorkingWithPeaks.Rmd",
    "properties" : {
    },
    "relative_order" : 5,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_markdown"
}